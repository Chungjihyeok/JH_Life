---
layout: post
title: Iris Data로 전처리부터 기계학습, 딥러닝까지
excerpt: "나만의 전처리 방식과 여러가지 알고리즘 비교 분석"
date: 2019-09-11
tag: 
- iris
- EDA 
- Machine Learning 
- Deep Learning
---


# Pipeline

```
0. Data 수집 
   - File Download
   - API 
   - Crawling & Scraping
1. 도메인 지식 확보 
   - Docs를 읽어본다 (주어 졌을때만)
   - 이미 내가 알고 있는 전문 분야를 활용한다 
   - 구글링 
   - 책 
2. Data 불러오기 
   - Pandas Dataframe으로 불러오기 
   - (비정형 데이터인 경우는 찾아봐야함..) 
3. Data 파악하기 
   - head로 대략적인 데이터 살피기 
   - Tidy Data인지 확인하기 
   - info로 데이터 정보 확인하기 
   - missing data 확인하기 
   - dtype 확인하기 
4. Data 전처리 하기 
   - Wide Format인 경우 melt 하기 
   - missing data 처리하기 
   - dtype 확인하고 encoding 하기 
   - train - test set 분리하기 
   - 부적절한 data 값 수정하기 
5. Data 분석하기 (EDA) 
   - describe로 대략적인 값의 특성 확인하기 
   - 그래프 그려 보기 
   - 왜도, 첨도 확인하기 
   - 데이터의 숨겨진 의미 파악하기 
   - 데이터 양이 충분한지 파악하기 (중심 극한 정리)  
   - Feature 갯수가 데이터의 양에 비해 많은지 확인하기 (오캄의 면도날) 
6. 모델링 하기 
   - 기계학습 or 딥러닝 
   - 지도학습 or 비지도학습 or 강화학습 
   - 자연어 or 이미지 or 음성 처리 
   - 모델링 순서 
   - 알고리즘 비교하기 
7. 성능 테스트 
```

<hr> 
<br>

## 도메인 지식 확보하기 

> 1. Data를 내려받아 쓰는 경우 Docs가 있다면 잘 읽어보고 데이터를 이해한다 <br>
> 2. Docs가 없고 도메인 지식이 없을 경우 구글링을 하거나 책을 통해 공부한다 <br> 
> 3. 웬만하면 내가 관심있는 분야를 선정한다 <br> 

<br>

## 데이터 불러오기 

> Pandas DataFrame에 맞게 불러온다 

<br>

### seaborn에서 불러올 때 

```python
import pandas as pd 
import seaborn as sns 

iris = sns.load_dataset('iris') 
```

<br>

### file에서 불러올 때 

```python
import pandas as pd 

iris = pd.read_csv('iris.csv', engine='python')  # 필요에 따라 옵션이 달라질 수 있다. 
```

<br>

### api로 불러올 때 

```python 

```

<br>

## Data 파악하기 

### HEAD 

```python
import pandas as pd 
import seaborn as sns 

iris = sns.load_dataset('iris') 

iris.head(5)
```

![head](https://user-images.githubusercontent.com/33630505/64856526-20141380-d65d-11e9-9953-e1ee87c3f7b3.JPG)

<br>

## Tidy Data인지 

> 데이터 양에 비해 Wide Format인지 아직 판단하기 이르지만 <br>
> 언뜻 봐서 melt할만한 Column은 없어보인다. <br>

**Wide Format** 데이터의 양에 비해 Column이 많은 DataFrame, 즉 가로로 넓은 형태의 데이터 형태를 말한다.
{: .notice}

<br>

## info로 데이터 정보 확인하기

```python
import pandas as pd 
import seaborn as sns 

iris = sns.load_dataset('iris') 

iris.info()
```

![info](https://user-images.githubusercontent.com/33630505/65045477-cdf32b00-d999-11e9-9e55-a91c88aa1fa1.JPG)


<span style="font-size: 20px; font-color: #fbba2d;"> info로 알 수 있는 것들 </span> 

```
1. 데이터 갯수  => 150개 (데이터 양이 적다. 하지만 예제 데이터이니 일단 한번 끝까지 해보자)
2. Feature 갯수 => 4개 (Data 150개에 4개 Feature면 적당한가? 아직 모름)
3. Dtype  => Feature 4개 모두 float64 , target data인 species는 object (기계학습 할때 int나 float형으로 바꿔야 겠다)
4. Memory size => 6.0+KB (작다. 불러오는데 큰 문제 없음. memory size가 몇 이하여야 하는지는 잘 모름)
5. Missing Data => 없음
```

## 미싱데이터 시각화 하기 

> info로 미싱데이터를 확인 했지만 혹시 어정쩡하게 미싱 데이터가 있거나 <br>
> 미싱데이터의 분포를 쉽게 확인하려면 그래프를 그리자


```python
import missingno as mino
import pandas as pd 
import seaborn as sns 

iris = sns.load_dataset('iris') 
mino.matrix(iris)
```

![mino](https://user-images.githubusercontent.com/33630505/65046346-6807a300-d99b-11e9-8cac-22dfd78dc068.JPG)



<br>

## Label Encoding

> info를 확인 했을 때 species data를 숫자형으로 바꿔야 된다고 판단 했었고 target 데이터의 값이 문자이면 <br>
> 학습을 할 수 없기 때문에 숫자로 인코딩 해준다 (인코딩과 동시에 dtype 자동변경)

### Scikit LabelEncoder 활용하기 
```python
import pandas as pd 
import seaborn as sns 
from sklearn.preprocessing import LabelEncoder

iris = sns.load_dataset('iris') 
target = iris.iloc[:,-1]

le = LabelEncoder()
le.fit_transform(target)
: array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
target = pd.DataFrame(le.fit_transform(target))         
target.rename({0:'target'}, axis=1, inplace=True)
```

<br>

### Replace 활용하기 

```python
import pandas as pd 
import seaborn as sns 

iris = sns.load_dataset('iris') 
target = iris.iloc[:,-1]

target.replace({'setosa':0,'versicolor':1,'virginica':2}, inplace=True)
```
<br>

### Label Encoding의 장점과 단점 

표



